<!doctype html>
<html>
    <head>
        <title>PgBox - easy postgresql server get up and go</title>
        <link rel="stylesheet" href="main.css" type="text/css"></link>
        <link rel="stylesheet" href="node-syntax.css" type="text/css"></link>
        <link rel="stylesheet" href="bootstrap/css/bootstrap.min.css" type="text/css"></link>
        <meta http-equiv="Content-Type" content="text/html; charset=utf-8"></meta>
        <script src="jquery-1.10.2.min.js" language="javascript"></script>
        <script src="bootstrap/js/bootstrap.min.js" language="javascript"></script>
        <script>
//<!--
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-24502836-6', 'pgdevbox.com');
  ga('send', 'pageview');
//-->
        </script>
    </head>
    <body data-spy="scroll" data-target=".navbar">
        <div class="navbar">
            <div class="navbar-inner">
                <a class="brand" href="#">pgdevbox</a>
                <ul class="nav">
                    <li class="active"><a href="#leader">home</a></li>
                    <li><a href="#whatyouneedpart">depends</a></li>
                    <li><a href="#getgoingpart">get started</a></li>
                    <li><a href="#includedpart">what's in it</a></li>
                    <li><a href="#nodejspart">how to ...</a></li>
                </ul>
            </div>
        </div>
        <div id="page">
            <div id="leader">
                <div class="container">
                    <div class="row-fluid">
                        <span id="video">
                            <iframe width="480" height="360" src="//www.youtube.com/embed/cdXqPe1-kS4?rel=0" frameborder="0" allowfullscreen></iframe>
                        </span>
                        <h1 id="pgdexbox">Postgres Dev Box</h1>
                        
                        <p>The easiest way to get going quickly with PostgreSQL. 
                        Download and install this <a target="newframe" href="http://vagrantup.com">vagrant box</a> 
                        and be ready in minutes.</p>

                        <ul>
                            <li><a href="#whatyouneedpart">what you need to use it</a></li>
                            <li><a href="#getgoingpart">get going</a></li>
                            <li><a href="#includedpart">what's included</a></li>
                            <li><a href="#nodejspart">how to with node.js</a></li>
                        </ul>

                        <h4 class="payment">Donations</h4>
                        <p class="payment">
                            If you use the pgdevbox please consider donating a small sum to Nic Ferrier, who maintains it for you
                            <iframe style="border: 0; margin: 0; padding: 0;"
                                    src="https://www.gittip.com/nicferrier/widget.html"
                                    width="48pt" height="22pt"></iframe>
                        </p>
                    </div>
                </div>
            </div>
            <div class="part" id="whatyouneedpart">
                <div class="container">
                    <div class="row-fluid">
                        <h2 id="whatyouneed">What you need</h2>
                        <ul>
                            <li><a target="newframe" href="https://www.virtualbox.org/wiki/Downloads">virtualbox</a></li>
                            <li><a target="newframe" href="http://downloads.vagrantup.com/tags/v1.2.4">vagrant</a></li>
                        </ul>
                        <ul class="nav nav-tabs" id="use-tabs">
                            <li class="active">
                                <a href="#use-osx" data-toggle="tab">Using OSX</a>
                            </li>
                            <li><a href="#use-ubuntu" data-toggle="tab">Using Ubuntu</a></li>
                            <li><a href="#use-windows" data-toggle="tab">Using Windows</a></li>
                        </ul>
                        <div class="tab-content">
                            <div class="tab-pane active" id="use-osx">
                                <h3>If you use OSX</h3>
                                <div class="usage">
                                    <p>Install <a target="newframe" href="http://mxcl.github.io/homebrew/">brew</a> and then:</p>
                                    
                                    <pre>
brew install virtualbox
                                    </pre>

                                    <p>then <a target="newframe" href="http://files.vagrantup.com/packages/0219bb87725aac28a97c0e924c310cc97831fd9d/Vagrant-1.2.4.dmg">install this</a></p>
                                </div>
                            </div>
                            <div class="tab-pane" id="use-ubuntu">
                                <h3>If you use Ubuntu</h3>
                                <div class="usage">
                                    <p>Do this:</p>
                                    
                                    <pre>
sudo apt-get install virtualbox
curl -L http://files.vagrantup.com/packages/0219bb87725aac28a97c0e924c310cc97831fd9d/vagrant_1.2.4_i686.deb -o ~/vagrant_1.2.4_i686.deb 
sudo dpkg -i ~/vagrant_1.2.4_i686.deb 
                                    </pre>
                                    
                                    <em>Note this is for the 32 bit version of vagrant, see
                                    the <a target="newframe" href="http://downloads.vagrantup.com/tags/v1.2.4">vagrant site</a> for
                                    information on how to install the 64 bit version</em>
                                </div>
                            </div>
                            
                            <div class="tab-pane" id="use-windows">
                                <h3>If you use Windows</h3>
                                <div class="usage">
                                    <p>Firstly, consider switching. Windows really is a useless developers
                                    operating system. But, if you really can't swap then:</p>
                                    
                                    <ul>
                                        <li>install <a target="newframe" href="https://www.virtualbox.org/wiki/Downloads">virtualbox</a></li>
                                        <li>download <a target="newframe" href="http://files.vagrantup.com/packages/0219bb87725aac28a97c0e924c310cc97831fd9d/Vagrant_1.2.4.msi">and run this</a></li>
                                    </ul>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div id="getgoingpart" class="part">
                <div class="container">
                    <div class="row-fluid">
                        <h2 id="getgoing">Get going quickly</h2>
                        
                        <p>Here's how to get going.</p>

                        <pre>
mkdir mypg-project
cd mypg-project
curl http://www.pgdevbox.com/Vagrantfile -o Vagrantfile
vagrant up
                        </pre>

                        <p>Now you have a running PostgreSQL server.</p>

                        <p>It's easy to to play with it using the built in psql shell inside the vagrant machine; from your shell:</p>

                        <pre>
$ vagrant ssh -- -t psql
psql (9.3beta2)
Type "help" for help.

vagrant= <span class="keyword">\d</span>

        List of relations
 Schema | Name | Type  |  Owner  
--------+------+-------+---------
 public | a    | table | vagrant
(1 row)
                        </pre>

                        <p>will show a list of the tables installed, or show the structure of this table:</p>

                        <pre>
vargrant= <span class="keyword">\d</span> <span class="string">a</span>

     Table "public.a"
 Column | Type | Modifiers 
--------+------+-----------
 a      | json | 

                        </pre>

                        <p>finally <code>\quit</code> will quit the psql shell.</p>

                        <p>
                            You can find out more about <a href="http://www.postgresql.org/docs/devel/static/app-psql.html">psql here.</a>
                        </p>
                    </div>
                </div>
            </div>
            <div id="includedpart" class="part">
                <div class="container">
                    <div class="row-fluid">
                        <h2 id="included">What does the server have?</h2>
                        
                        <p>The pgbox postgres has a single PostgreSQL 9.3 server with:</p>
                        
                        <ul>
                            <li>a superuser called <em>vagrant</em></li>
                            <li>a database called <em>vagrant</em> owned by the user <em>vagrant</em></li>
                            <li>a single <a target="newframe" href="http://www.postgresql.org/docs/9.3/static/datatype-json.html">JSON column table</a> in the <em>vagrant</em> database called <em>a</em></li>
                        </ul>

                    </div>
                </div>
            </div>
            <div id="nodejspart" class="part">
                <div class="container">
                    <div class="row-fluid">
                        <h2 id="nodejs">How do I use it with node.js?</h2>

                        <ul>
                            <li>install <a target="newframe" href="http://nodejs.org/">node.js</a></li>
                            <li>npm install <a target="newframe" href="https://github.com/brianc/node-postgres/wiki/Client#method-query-simple">pg</a></li>
                        </ul>

                        <ul class="nav nav-tabs" id="use-tabs">
                            <li class="active"><a href="#nodejs-insertdata" data-toggle="tab">insert some data</a></li>
                            <li><a href="#nodejs-getdata" data-toggle="tab">get some data</a></li>
                            <li><a href="#nodejs-createtable" data-toggle="tab">create a table</a></li>
                        </ul>

                        <div class="tab-content">
                            <div class="tab-pane active" id="nodejs-insertdata">
                                <p>Use SQL <code>INSERT</code> to put some JSON in the table:</p>
                                <pre>
<span class="keyword">var</span> <span class="variable-name">data</span> = { <span class="variable-name">"a"</span>: <span class="string">"10"</span>, <span class="variable-name">"b"</span>: <span class="string">"20"</span> };
<span class="keyword">var</span> <span class="variable-name">pg</span> = require(<span class="string">'pg'</span>); 
<span class="keyword">var</span> <span class="variable-name">client</span> = <span class="keyword">new</span> pg.Client(<span class="string">"tcp://vagrant@localhost/vagrant"</span>); 
client.connect(
    <span class="keyword">function</span> (<span class="js2-function-param">err</span>) { 
        <span class="keyword">if</span> (err) { 
            <span class="keyword">return</span> console.error(<span class="string">"bah!"</span>); 
        } 
        <span class="keyword">else</span> { 
            <span class="keyword">return</span> client.query(
                <span class="string">"insert into a (a) values ('"</span> + JSON.stringify(data) + <span class="string">"'::</span><span class="string"><span class="flyspell-incorrect">json</span></span><span class="string">)"</span>, 
                <span class="keyword">function</span> (<span class="js2-function-param">err</span>, <span class="js2-function-param">res</span>) { 
                    <span class="keyword">if</span> (err) { 
                        <span class="keyword">return</span> console.error(<span class="string">"whoops!"</span>); 
                    } 
                    <span class="keyword">else</span> { 
                        client.end(); 
                        <span class="keyword">return</span> res;
                    } 
                } 
            ); 
        } 
    } 
); 
                                </pre>
                            </div>
                            <div class="tab-pane" id="nodejs-getdata">
                                <p>Or SQL <code>SELECT</code> something from the existing table:</p>
                                <pre class="js">
<span class="keyword">var</span> <span class="variable-name">pg</span> = require(<span class="string">'pg'</span>); 
<span class="keyword">var</span> <span class="variable-name">client</span> = <span class="keyword">new</span> pg.Client(<span class="string">"tcp://vagrant@localhost/vagrant"</span>); 
client.connect(
    <span class="keyword">function</span> (<span class="js2-function-param">err</span>) { 
        <span class="keyword">if</span> (err) { 
            <span class="keyword">return</span> console.error(<span class="string">"bah!"</span>); 
        } 
        <span class="keyword">else</span> { 
            <span class="keyword">return</span> client.query(
                <span class="string">"select * from a where a -&gt;&gt; 'a' = '10'"</span>, 
                <span class="keyword">function</span> (<span class="js2-function-param">err</span>, <span class="js2-function-param">res</span>) { 
                    <span class="keyword">if</span> (err) { 
                        <span class="keyword">return</span> console.log(<span class="string">"whoops!"</span>); 
                    } 
                    <span class="keyword">else</span> { 
                        <span class="keyword">var</span> <span class="variable-name">row</span> = res.rows[0]; 
                        client.end(); 
                        <span class="keyword">return</span> console.log(<span class="string">"result! "</span>, row[<span class="string">"a"</span>].a); 
                    } 
                } 
            ); 
        } 
    } 
); 
                                </pre>
                            </div>
                            <div class="tab-pane" id="nodejs-createtable">
                                <p>Create another table in the database:</p>
                                
                                <pre class="js">
<span class="keyword">var</span> <span class="variable-name">pg</span> = require(<span class="string">'pg'</span>);
<span class="keyword">var</span> <span class="variable-name">client</span> = <span class="keyword">new</span> pg.Client(<span class="string">"tcp://vagrant@localhost/vagrant"</span>);
client.connect(
    <span class="keyword">function</span> (<span class="js2-function-param">err</span>) { 
        <span class="keyword">if</span> (!err) {
            <span class="keyword">return</span> client.query (
                <span class="string">"create table b (id integer, txt text);"</span>, 
                <span class="keyword">function</span> (<span class="js2-function-param">err</span>, <span class="js2-function-param">res</span>) { 
                    <span class="keyword">if</span> (! err) { 
                        console.log(<span class="string">"result:"</span> , res);
                        client.end();
                        <span class="keyword">return</span> <span class="string">"created"</span>;
                    }
                }
            );
        }
    }
);
                                </pre>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <footer>
            <div class="container">
                <div class="row">
                    <ul>
                        <li>(C) 2013 N.J.Ferrier</li>
                    </ul>
                </div>
            </div>
        </footer>
    </body>
 </html>
                                        
